<!DOCTYPE html>
<html><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title> 82MHz </title>
    <link rel="stylesheet" href="/css/style.css">
</head><body>
        <div class="container">
            <div class="navblock">
                <div class="home-logo">
<header>
    <div class="logo"><a href="http://localhost:1313/">82MHz</a></div>
</header></div>
                <div class="home-nav">




<nav class="site-menu">
        <a href="/posts">blog</a>
    
        <a href="/thoughts">thoughts</a>
    
        <a href="/bookclub">bookclub</a>
    
        <a href="/links">links</a>
    
        <a href="/tags">tags</a>
    
    
        <a class="language-select" href="http://localhost:1313/posts/2023/07/fritzboxvpn/">EN</a>
  
</nav>


</div>
            </div>
            <div id="content">
    <article class="post_full">
        <header>
            <h1>FritzBoxVPN</h1>
            <p>
                Jul 28, 2023
            </p>
            <p>
                <span class="tags">
                    
                    
                        
                    

                </span>
            </p>
            <p>
                
                    Reading time: 3 minutes
                
            </p>
        </header>

        <section class="body">
            
            <p>Do you often find yourself stuck on an unencrypted public wifi where almost everything is blocked except for basic web browsing, and as a result your VPN doesn&rsquo;t work either? Here&rsquo;s a solution using SSH.</p>
<h3 id="the-problem">The Problem</h3>
<p>So here&rsquo;s a fun little story. My internet router is a FritzBox by a German company called AVM. I don&rsquo;t know if they&rsquo;re available abroad as well, but here in Germany they&rsquo;re the market leader by a huge margin.</p>
<p>One of the neat things of a FritzBox is that you can create VPN access to it, so when you&rsquo;re on the go and you&rsquo;re on an unsecured wifi you can just open a VPN connection to your FritzBox at home and off you go. Which is great for me, because I like taking my laptop to coffee shops or to the local library to work there for a bit, but they all have unencrypted wifi, so a VPN is a really handy thing.</p>
<p>But here&rsquo;s the catch, a lot of coffee shops also use FritzBox routers, because they allow for the creation of a guest wifi network that&rsquo;s separate from the normal wifi. And these guest networks can be configured to allow limited online access (for security reasons of course!), which basically means only ports 80 and 443 and maybe some ports for imap etc. are open. Everything else is blocked.</p>
<p>Which means that my VPN is blocked as well.</p>
<p>Which is just ironic if you think about it, FritzBox blocking their own VPN solution for &ldquo;added security&rdquo;.</p>
<p>Anyway, long story short, I&rsquo;m often stuck using a public unencrypted wifi without the option to use a VPN. Not ideal.</p>
<h3 id="the-solution">The Solution</h3>
<p>Luckily there is a solution, and it comes in the form of a SSH tunnel.</p>
<p>I have a Raspberry Pi at home running as a small home server, which is already accessible via SSH, so all I had to do is configure my router to allow connections from the outside to go through to the ssh port (22) on the Raspi.</p>
<p>And here&rsquo;s the clever bit: Of course I can&rsquo;t just open port 22 to the outside, because then I would be stuck not being able to connect - remember, public wifis are often blocking everything except the ports for http and https.</p>
<p>But nothing&rsquo;s stopping me from just forwarding port 80 (or 443) of the FritzBox to the ssh server and not the standard port 22&hellip; and then I can just connect to the IP or dyndns address of my FritzBox on port 80 and end up on my Raspi. Neat!</p>
<p>There&rsquo;s one more puzzle piece missing for a VPN solution, because I need to collect all my outgoing web traffic and tunnel it through this ssh connection back home, and for that there&rsquo;s an awesome piece of software called sshuttle.</p>
<p>And it&rsquo;s super easy to use and configure too, all you do is call it, tell it which address to connect to, and you&rsquo;re done.</p>
<pre><code>sudo sshuttle -r ak@fritti.82mhz.net:80 0.0.0.0/0 --dns
</code></pre>
<p>Simple as that.</p>

        </section>
    </article>

            </div><div class="footer">
    <div class="footer_social-icons">

    <a href="mailto:82mhz@mailbox.org" target="_blank" rel="noopener noreferrer me"
        title="Email">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 21" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round" width="25px">
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
    <polyline points="22,6 12,13 2,6"></polyline>
</svg>
    </a>



    <a href="https://oldbytes.space/@82mhz" target="_blank" rel="noopener noreferrer me"
        title="Mastodon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round" width="25px">
    <path
        d="M21.58 13.913c-.29 1.469-2.592 3.121-5.238 3.396-1.379.184-2.737.368-4.185.276-2.368-.092-4.237-.551-4.237-.551 0 .184.014.459.043.643.308 2.294 2.317 2.478 4.22 2.57 1.922 0 3.633-.46 3.633-.46l.079 1.653s-1.344.734-3.738.918c-1.32.091-2.96-.092-4.869-.551-4.14-1.102-4.853-5.507-4.961-10.005-.034-1.285-.013-2.57-.013-3.58 0-4.589 3-5.966 3-5.966 1.513-.734 4.11-1.01 6.808-1.01h.067c2.699 0 5.296.276 6.81 1.01 0 0 3 1.377 3 5.967 0 0 .037 3.304-.419 5.69"
        stroke="currentColor" />
    <path
        d="M17.832 8.633v5h-1.978V8.78c0-1.023-.43-1.542-1.29-1.542-.95 0-1.427.616-1.427 1.834v2.655H11.17V9.072c0-1.218-.476-1.834-1.427-1.834-.86 0-1.29.52-1.29 1.542v4.852H6.475V8.633c0-1.022.26-1.834.782-2.434.538-.6 1.243-.909 2.118-.909 1.012 0 1.779.39 2.286 1.169l.492.827.493-.827c.507-.78 1.274-1.169 2.286-1.169.875 0 1.58.308 2.118.909.522.6.782 1.412.782 2.434"
        fill="currentColor" stroke="none" />
</svg>
    </a>


</div>
</div></div>
    </body>
</html>
